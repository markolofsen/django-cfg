---
title: Troubleshooting
description: Common issues and solutions for Next.js admin panel integration
---

import { Callout } from 'nextra/components'

# Troubleshooting

Common issues and their solutions when working with Next.js admin panels.

## Route Not Available

### Symptom

You see a "Route Not Available" error page when accessing certain routes in static mode.

### Cause

The requested route doesn't have a pre-rendered HTML file in the static export. This happens when:

- Dynamic routes lack `generateStaticParams()`
- Page uses `export const dynamic = 'force-dynamic'`
- Build error prevented page export
- ZIP archive is outdated

### Solutions

**Option 1: Use Development Mode**

```bash
cd frontend/apps/admin
pnpm dev  # Runs on port 3000
```

Django will automatically use the dev server instead of static files.

**Option 2: Add generateStaticParams**

For dynamic routes, add static parameter generation:

```tsx filename="app/(pages)/admin/items/[id]/page.tsx"
export async function generateStaticParams() {
  // Return all possible parameter combinations
  return [
    { id: '1' },
    { id: '2' },
    { id: '3' },
  ];
}
```

**Option 3: Rebuild Static Export**

```bash
cd solution/projects/django
make api  # Regenerate and rebuild
```

## JWT Tokens Not Working

### Symptom

API calls return 401 Unauthorized, or "Not authenticated" message appears.

### Cause

JWT tokens are not being injected or passed correctly.

### Solutions

**Check Django Login**

Ensure you're logged in to Django Admin before accessing the Next.js panel.

**Check Console Logs**

Open browser DevTools and look for:

```
[Next.js Admin] JWT tokens injected
```

If missing, the injection failed.

**Hard Refresh**

Clear cached HTML:

```
Cmd+Shift+R (Mac)
Ctrl+Shift+R (Windows/Linux)
```

**Check localStorage**

```javascript
// In browser console
console.log(localStorage.getItem('auth_token'));
console.log(localStorage.getItem('refresh_token'));
```

**Verify Token Format**

```javascript
// Check if token is valid JWT
const token = localStorage.getItem('auth_token');
const parts = token?.split('.');
console.log('JWT parts:', parts?.length);  // Should be 3
```

## TypeScript Errors

### Symptom

`tsc --noEmit` shows errors after generating clients.

### Cause

Generated types may conflict with existing code, or imports may be incorrect.

### Solutions

**Regenerate with Validation**

```bash
python manage.py validate_openapi --fix
python manage.py generate_client
```

**Check Import Paths**

Ensure imports use the correct paths:

```tsx
// Correct
import { useMyappItemsList } from '@/app/_lib/api/generated/custom/_utils/hooks';

// Incorrect (missing _utils)
import { useMyappItemsList } from '@/app/_lib/api/generated/custom/hooks';
```

**Clear Generated Files**

```bash
rm -rf app/_lib/api/generated/*
make api
```

## Infinite Redirect Loop

### Symptom

Browser shows continuous loading, or server logs show repeated requests to the same URL every 100-200ms.

### Cause

This was a known issue when:
1. A route doesn't exist in static export (no `index.html`)
2. SPA router falls back to root `index.html`
3. Next.js router redirects back to the original route
4. Cycle repeats infinitely

### Solution

This issue has been fixed in Django-CFG. The system now shows a helpful "Route Not Available" page instead of causing infinite loops.

If you still experience this:

1. Update Django-CFG to the latest version
2. Clear browser cache
3. Delete and re-extract the ZIP:

```bash
rm -rf static/nextjs_admin/
rm static/nextjs_admin/.zip_meta
# Restart Django or make a request
```

## CORS Errors

### Symptom

API calls fail with CORS errors in the browser console.

### Cause

Django isn't allowing requests from the Next.js dev server origin.

### Solution

Add CORS configuration:

```python filename="settings.py"
CORS_ALLOWED_ORIGINS = [
    "http://localhost:3000",
]

# Or for development:
CORS_ALLOW_ALL_ORIGINS = True  # Not for production!
```

Install django-cors-headers if needed:

```bash
pip install django-cors-headers
```

## ZIP Not Extracting

### Symptom

Django returns 404 even though ZIP file exists.

### Cause

- ZIP file is corrupted
- Extraction failed silently
- Permission issues

### Solutions

**Check ZIP Integrity**

```bash
unzip -t static/nextjs_admin.zip
```

**Manual Extraction Test**

```bash
cd static
rm -rf nextjs_admin/
unzip nextjs_admin.zip -d nextjs_admin/
ls nextjs_admin/  # Should show: admin/, _next/, index.html
```

**Check Permissions**

```bash
ls -la static/
# Django process needs write access
```

**Check Django Logs**

Enable debug logging:

```python
LOGGING = {
    'loggers': {
        'django_cfg.modules.nextjs_admin': {
            'level': 'DEBUG',
        },
    },
}
```

## Static Assets Not Loading

### Symptom

Page loads but styles are missing, or JavaScript errors appear.

### Cause

`_next/` assets aren't being served correctly.

### Solutions

**Check Asset Paths**

In browser DevTools Network tab, look for 404s on `_next/static/*` requests.

**Verify ZIP Contents**

```bash
unzip -l static/nextjs_admin.zip | grep _next
```

Should show `_next/static/chunks/`, `_next/static/css/`, etc.

**Check Static URL Configuration**

```python
NextJsAdminConfig(
    static_url="/cfg/nextjs-admin/",  # Must match URL pattern
)
```

## SWR Cache Issues

### Symptom

Data doesn't update after mutations, or stale data appears.

### Solutions

**Manual Revalidation**

```tsx
const { mutate } = useMyappItemsList();

// After creating/updating/deleting
await fetchMyappItemsCreate(data);
mutate();  // Force refresh
```

**Global Revalidation**

```tsx
import { mutate } from 'swr';

// Revalidate all SWR caches
mutate(() => true);
```

**Disable Cache for Testing**

```tsx
<SWRConfig value={{
  provider: () => new Map(),  // Fresh cache on each render
}}>
```

## Debug Checklist

<Callout type="info">
Use this checklist when troubleshooting:

1. [ ] Django server running?
2. [ ] Logged in to Django Admin?
3. [ ] Next.js dev server running (for dev mode)?
4. [ ] ZIP file exists in `static/nextjs_admin.zip`?
5. [ ] ZIP extracted to `static/nextjs_admin/`?
6. [ ] JWT tokens in localStorage?
7. [ ] API requests have Authorization header?
8. [ ] No CORS errors in console?
9. [ ] No TypeScript errors (`pnpm typecheck`)?
10. [ ] Routes have `index.html` in static export?
</Callout>

## Getting Help

If issues persist:

1. Check Django logs for detailed error messages
2. Enable debug mode in Django-CFG
3. Review browser DevTools (Console, Network tabs)
4. Search existing documentation at [/features/integrations/nextjs-admin](/docs/features/integrations/nextjs-admin)
